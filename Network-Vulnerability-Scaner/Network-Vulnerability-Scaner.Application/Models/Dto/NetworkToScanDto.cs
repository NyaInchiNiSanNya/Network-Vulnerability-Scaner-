using AutoMapper;
using Network_Vulnerability_Scaner.Application.Models.Requests_Responses;
using Network_Vulnerability_Scaner.Domain.Entities;

namespace Network_Vulnerability_Scaner.Application.Models.Dto
{
    public class NetworkToScanDto
    {
        public String Ip { get; set; }
        public List<Int32>? Ports { get; set; }
        public Boolean Tcp { get; set; }
        public String TcpScanMethod { get; set; }
        public Boolean Udp { get; set; }
        public Boolean VulnSearch { get; set; }
        public Boolean ConfigurationCheck { get; set; }

        public class Map : Profile
        {
            public Map()
            {
                CreateMap<NetworkToScanDto, NetworkToScanRequest>().ReverseMap()
                    .ForMember(request => request.Ports, opt
                        => opt.MapFrom(dto 
                            => dto.Ports!.Split().Select(x=>Convert.ToInt32(x)).ToList()));
                CreateMap<NetworkConfiguration,NetworkToScanDto>().ReverseMap();
            }

        }
    }
}
