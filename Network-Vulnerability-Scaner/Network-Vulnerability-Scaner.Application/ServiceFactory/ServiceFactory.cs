using AutoMapper;
using FluentValidation;
using Network_Vulnerability_Scaner.Application.Interfaces;
using Microsoft.Extensions.DependencyInjection;
using Network_Vulnerability_Scaner.Application.Models.Dto;
using Network_Vulnerability_Scaner.Application.Models.Requests_Responses;
using Network_Vulnerability_Scaner.Domain.Interfaces;
using Network_Vulnerability_Scaner.Application.Services;
using Network_Vulnerability_Scaner.Domain.Entities;

namespace Network_Vulnerability_Scaner.Application.ServiceFactory
{
    public class ServiceFactory : IServiceFactory
    {
        private readonly IServiceProvider _serviceProvider;

        public ServiceFactory(IServiceProvider serviceProvider)
        {
            _serviceProvider = serviceProvider;
        }

        IMapper IServiceFactory.CreateMapperService()
        {
            return _serviceProvider.GetService<IMapper>()
                   ?? throw new NullReferenceException(nameof(IMapper));
        }

        IScanService IServiceFactory.CreateScanService()
        {
            return _serviceProvider.GetService<IScanService>()
                   ?? throw new NullReferenceException(nameof(IScanService));
        }

        IReportService IServiceFactory.CreateReportService()
        {
            return _serviceProvider.GetService<IReportService>()
                   ?? throw new NullReferenceException(nameof(IReportService));
        }
        IVulnSearchService IServiceFactory.CreateVulnSearchService()
        {
            return _serviceProvider.GetService<IVulnSearchService>()
                   ?? throw new NullReferenceException(nameof(IVulnSearchService));
        }

        IVulnSearchDomainService IServiceFactory.CreateVulnSearchDomainService()
        {
            return _serviceProvider.GetService<IVulnSearchDomainService>()
                   ?? throw new NullReferenceException(nameof(IVulnSearchDomainService));
        }

        IValidator<NetworkToScanRequest> IServiceFactory.CreateScanRequestValidator()
        {
            return _serviceProvider.GetService<IValidator<NetworkToScanRequest>>()
                   ?? throw new NullReferenceException(nameof(IValidator<NetworkToScanRequest>));
        }

        IValidator<NetworkToScanDto> IServiceFactory.CreateScanDtoValidator()
        {
            return _serviceProvider.GetService<IValidator<NetworkToScanDto>>()
                   ?? throw new NullReferenceException(nameof(IValidator<NetworkToScanDto>));
        }

        IValidator<dataForVulnsSearchDto> IServiceFactory.CreateDataForVulnDtoValidator()
        {
            return _serviceProvider.GetService<IValidator<dataForVulnsSearchDto>>()
                   ?? throw new NullReferenceException(nameof(IValidator<dataForVulnsSearchDto>));
        }

        IValidator<GetVulnerabilityRequest> IServiceFactory.CreateVulnerabilityRequestValidator()
        {
            return _serviceProvider.GetService<IValidator<GetVulnerabilityRequest>>()
                   ?? throw new NullReferenceException(nameof(IValidator<GetVulnerabilityRequest>));
        }

        IValidator<PortDto> IServiceFactory.CreatePortDtoValidator()
        {
            return _serviceProvider.GetService<IValidator<PortDto>>()
                   ?? throw new NullReferenceException(nameof(IValidator<PortDto>));
        }

        IScanMethodsService IServiceFactory.CreateScanMethodsService()
        {
            return _serviceProvider.GetService<IScanMethodsService>()
                   ?? throw new NullReferenceException(nameof(IScanMethodsService));
        }
    }
}
